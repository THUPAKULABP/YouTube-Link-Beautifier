<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CineEmbed - Interactive Player Generator</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Outfit', sans-serif;
            background-color: #000000;
            color: #e2e8f0;
            background-image: 
                radial-gradient(circle at 15% 50%, rgba(76, 29, 149, 0.15), transparent 25%), 
                radial-gradient(circle at 85% 30%, rgba(219, 39, 119, 0.15), transparent 25%);
            min-height: 100vh;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #0f172a;
        }
        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 3px;
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s ease, border-color 0.3s ease;
        }

        .glass-panel:hover {
            border-color: rgba(255, 255, 255, 0.15);
        }

        .input-group {
            transition: all 0.3s ease;
        }
        .input-group:focus-within {
            transform: translateY(-2px);
        }

        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .animate-pop {
            animation: pop 0.2s ease-in-out;
        }

        @media (max-width: 768px) {
            .glass-panel { padding: 1.25rem !important; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // --- Icons ---
        const IconBase = ({ children, ...props }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>{children}</svg>
        );
        const Play = (props) => <IconBase {...props}><polygon points="5 3 19 12 5 21 5 3" /></IconBase>;
        const Monitor = (props) => <IconBase {...props}><rect x="2" y="3" width="20" height="14" rx="2" ry="2" /><line x1="8" y1="21" x2="16" y2="21" /><line x1="12" y1="17" x2="12" y2="21" /></IconBase>;
        const Zap = (props) => <IconBase {...props}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" /></IconBase>;
        const Code = (props) => <IconBase {...props}><polyline points="16 18 22 12 16 6" /><polyline points="8 6 2 12 8 18" /></IconBase>;
        const Check = (props) => <IconBase {...props}><polyline points="20 6 9 17 4 12" /></IconBase>;
        const Copy = (props) => <IconBase {...props}><rect x="9" y="9" width="13" height="13" rx="2" ry="2" /><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" /></IconBase>;
        const Smartphone = (props) => <IconBase {...props}><rect x="5" y="2" width="14" height="20" rx="2" ry="2" /><line x1="12" y1="18" x2="12.01" y2="18" /></IconBase>;
        const Wand = (props) => <IconBase {...props}><path d="M15 4V2" /><path d="M15 16v-2" /><path d="M8 9h2" /><path d="M20 9h2" /><path d="M17.8 11.8 19 13" /><path d="M15 9h0" /><path d="M17.8 6.2 19 5" /><path d="m3 21 9-9" /><path d="M12.2 6.2 11 5" /></IconBase>;

        const App = () => {
            const [url, setUrl] = useState('');
            const [videoId, setVideoId] = useState(null);
            const [defaultTheme, setDefaultTheme] = useState('ambient'); 
            const [outputMode, setOutputMode] = useState('embed');
            const [copied, setCopied] = useState(false);
            const [previewKey, setPreviewKey] = useState(0);

            useEffect(() => {
                if (!url) { setVideoId(null); return; }
                let id = '';
                try {
                    let clean = url;
                    if (url.includes('<iframe')) {
                        const srcMatch = url.match(/src="([^"]+)"/);
                        if (srcMatch) clean = srcMatch[1];
                    }
                    const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
                    const match = clean.match(regExp);
                    if (match && match[2].length === 11) id = match[2];
                } catch(e) {}
                setVideoId(id || null);
            }, [url]);

            useEffect(() => {
                setPreviewKey(k => k + 1);
            }, [videoId, defaultTheme]);

            const copyToClipboard = () => {
                const code = outputMode === 'fullpage' ? generateFullPage() : generateEmbed();
                const textArea = document.createElement("textarea");
                textArea.value = code;
                textArea.style.position = "fixed"; textArea.style.left = "-9999px";
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    document.execCommand('copy');
                    setCopied(true);
                    setTimeout(() => setCopied(false), 2000);
                } catch (err) {}
                document.body.removeChild(textArea);
            };

            const getThumbnail = (id) => `https://img.youtube.com/vi/${id}/maxresdefault.jpg`;

            // --- THE INTERACTIVE PLAYER GENERATOR ---
            const generateEmbed = () => {
                if (!videoId) return '<!-- Enter a URL to generate code -->';
                
                const thumb = getThumbnail(videoId);
                const uniqueId = 'cine-' + Math.random().toString(36).substr(2, 6);
                
                // CSS for all themes (embedded directly in the output)
                const styles = `
                    <style>
                        /* Base Layout */
                        #${uniqueId} { width: 100%; max-width: 900px; margin: 0 auto; position: relative; font-family: sans-serif; isolation: isolate; }
                        #${uniqueId} .cine-wrapper { position: relative; width: 100%; aspect-ratio: 16/9; background: #000; overflow: hidden; z-index: 2; transition: all 0.5s ease; }
                        #${uniqueId} .cine-thumb { position: absolute; inset: 0; background-image: url('${thumb}'); background-size: cover; background-position: center; transition: transform 0.5s ease; }
                        #${uniqueId} .cine-wrapper:hover .cine-thumb { transform: scale(1.03); }
                        
                        /* Play Button */
                        #${uniqueId} .cine-play { 
                            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                            width: 68px; height: 48px; background: rgba(20,20,20,0.8); backdrop-filter: blur(4px);
                            border-radius: 12px; display: flex; align-items: center; justify-content: center; 
                            cursor: pointer; transition: all 0.3s; z-index: 10;
                        }
                        #${uniqueId} .cine-play:hover { background: #f00; transform: translate(-50%, -50%) scale(1.1); box-shadow: 0 0 20px rgba(255,0,0,0.5); }
                        #${uniqueId} .cine-play svg { width: 16px; height: 16px; fill: white; }

                        /* Theme Switcher UI */
                        #${uniqueId} .theme-toggle {
                            position: absolute; top: 15px; right: 15px; z-index: 50;
                            width: 32px; height: 32px; background: rgba(0,0,0,0.6); backdrop-filter: blur(8px);
                            border: 1px solid rgba(255,255,255,0.2); border-radius: 50%;
                            display: flex; align-items: center; justify-content: center;
                            cursor: pointer; opacity: 0; transition: opacity 0.3s, transform 0.2s;
                            color: white;
                        }
                        #${uniqueId}:hover .theme-toggle, #${uniqueId}.is-playing .theme-toggle:hover { opacity: 1; }
                        #${uniqueId} .theme-toggle:hover { transform: rotate(15deg) scale(1.1); background: rgba(255,255,255,0.2); }
                        
                        /* --- THEMES --- */
                        
                        /* Ambient */
                        #${uniqueId}[data-theme="ambient"] .cine-glow {
                            position: absolute; inset: -20px; background: url('${thumb}'); background-size: cover;
                            filter: blur(45px) brightness(0.7) saturate(1.5); opacity: 0.6; z-index: 1; border-radius: 30px;
                        }
                        #${uniqueId}[data-theme="ambient"] .cine-wrapper { border-radius: 16px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }

                        /* Neon */
                        #${uniqueId}[data-theme="neon"] .cine-wrapper {
                            border-radius: 12px; 
                            box-shadow: 0 0 10px #0ff, 0 0 20px #0ff, 0 0 40px #0ff;
                            border: 2px solid #0ff;
                        }
                        #${uniqueId}[data-theme="neon"] .cine-play { background: rgba(0,0,0,0.8); border: 1px solid #0ff; color: #0ff; }
                        #${uniqueId}[data-theme="neon"] .cine-play:hover { background: #0ff; box-shadow: 0 0 20px #0ff; }

                        /* Cinema */
                        #${uniqueId}[data-theme="cinema"] { max-width: 100%; background: #111; padding: 40px 0; }
                        #${uniqueId}[data-theme="cinema"] .cine-wrapper { aspect-ratio: 2.35/1; border-top: 1px solid #333; border-bottom: 1px solid #333; }
                        
                        /* Retro */
                        #${uniqueId}[data-theme="retro"] .cine-wrapper {
                            border: 4px solid #4ade80;
                            box-shadow: 6px 6px 0px #4ade80;
                            border-radius: 0;
                        }
                        #${uniqueId}[data-theme="retro"] .cine-play { border-radius: 0; background: #000; border: 2px solid #4ade80; }
                        #${uniqueId}[data-theme="retro"] .cine-play:hover { background: #4ade80; }

                        /* Cyber */
                        #${uniqueId}[data-theme="cyber"] .cine-wrapper {
                            clip-path: polygon(10% 0, 100% 0, 100% 85%, 90% 100%, 0 100%, 0 15%);
                            border-right: 2px solid #d946ef; border-left: 2px solid #d946ef;
                        }
                        #${uniqueId}[data-theme="cyber"] .cine-glow {
                            position: absolute; inset: -5px; background: linear-gradient(45deg, #d946ef, transparent, #3b82f6);
                            z-index: 1; opacity: 0.5; clip-path: polygon(10% 0, 100% 0, 100% 85%, 90% 100%, 0 100%, 0 15%);
                        }

                        /* Soft */
                        #${uniqueId}[data-theme="soft"] .cine-wrapper {
                            border-radius: 24px;
                            box-shadow: 0 25px 50px -12px rgba(100, 100, 255, 0.25);
                            border: 4px solid rgba(255,255,255,0.1);
                        }

                        /* Mobile overrides */
                        @media (max-width: 600px) {
                            #${uniqueId}[data-theme="cinema"] .cine-wrapper { aspect-ratio: 16/9; }
                        }
                    </style>
                `;

                // Logic to switch themes inside the embedded player
                const script = `
                <script>
                (function() {
                    var c = document.getElementById('${uniqueId}');
                    var toggle = c.querySelector('.theme-toggle');
                    var themes = ['ambient', 'neon', 'retro', 'cyber', 'soft', 'cinema', 'clean'];
                    var current = themes.indexOf('${defaultTheme}');
                    
                    // Theme Switcher Logic
                    toggle.addEventListener('click', function(e) {
                        e.stopPropagation(); // Don't trigger play
                        current = (current + 1) % themes.length;
                        c.setAttribute('data-theme', themes[current]);
                        
                        // Optional: Show toast name of theme (simplified for embed)
                        toggle.title = "Theme: " + themes[current];
                    });

                    // Video Play Logic
                    var w = c.querySelector('.cine-wrapper');
                    var p = c.querySelector('.cine-play');
                    var t = c.querySelector('.cine-thumb');
                    
                    function play() {
                        c.classList.add('is-playing');
                        var iframe = document.createElement('iframe');
                        iframe.src = 'https://www.youtube.com/embed/${videoId}?autoplay=1&modestbranding=1&playsinline=1&rel=0';
                        iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
                        iframe.allowFullscreen = true;
                        iframe.style.width = '100%';
                        iframe.style.height = '100%';
                        iframe.style.border = 'none';
                        iframe.style.position = 'absolute';
                        iframe.style.top = '0'; iframe.style.left = '0';
                        
                        t.style.opacity = 0;
                        p.style.display = 'none';
                        w.appendChild(iframe);
                    }
                    
                    p.addEventListener('click', play);
                    t.addEventListener('click', play);
                })();
                <\/script>
                `;

                return `<!-- CineEmbed Interactive Player -->
${styles}
<div id="${uniqueId}" data-theme="${defaultTheme}">
    <div class="cine-glow"></div>
    <div class="theme-toggle" title="Change Theme">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v4"/><path d="M12 18v4"/><path d="M4.93 4.93l2.83 2.83"/><path d="M16.24 16.24l2.83 2.83"/><path d="M2 12h4"/><path d="M18 12h4"/><path d="M4.93 19.07l2.83-2.83"/><path d="M16.24 7.76l2.83-2.83"/></svg>
    </div>
    <div class="cine-wrapper">
        <div class="cine-thumb"></div>
        <div class="cine-play">
            <svg viewBox="0 0 24 24"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
        </div>
    </div>
</div>
${script}`;
            };

            const generateFullPage = () => {
                const embedCode = generateEmbed();
                return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Watch Video</title>
    <style>
        body { margin: 0; padding: 0; background: #050505; min-height: 100vh; display: flex; align-items: center; justify-content: center; overflow-x: hidden; }
    </style>
</head>
<body>
    ${embedCode}
</body>
</html>`;
            };

            const themes = [
                {id: 'ambient', name: 'Ambient', desc: 'Immersive Glow'},
                {id: 'neon', name: 'Neon', desc: 'Sci-Fi Border'},
                {id: 'retro', name: 'Retro', desc: '8-Bit Style'},
                {id: 'cyber', name: 'Cyber', desc: 'Glitch/Angled'},
                {id: 'soft', name: 'Soft', desc: 'Glassmorphism'},
                {id: 'cinema', name: 'Cinema', desc: 'Wide Theater'},
                {id: 'clean', name: 'Clean', desc: 'Minimalist'}
            ];

            return (
                <div className="min-h-screen text-slate-200 selection:bg-purple-500/30">
                    <header className="border-b border-white/5 bg-black/50 backdrop-blur-md sticky top-0 z-50">
                        <div className="max-w-7xl mx-auto px-4 md:px-6 h-16 md:h-20 flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <div className="w-8 h-8 md:w-10 md:h-10 rounded-xl bg-gradient-to-br from-purple-600 to-pink-600 flex items-center justify-center shadow-lg shadow-purple-900/20">
                                    <Play className="text-white w-4 h-4 md:w-5 md:h-5 fill-current" />
                                </div>
                                <div>
                                    <h1 className="text-lg md:text-xl font-bold tracking-tight text-white">CineEmbed 2.0</h1>
                                </div>
                            </div>
                            <div className="flex items-center gap-4 text-xs md:text-sm font-medium text-slate-400">
                                <div className="hidden md:flex items-center gap-2 text-purple-400">
                                    <Wand className="w-4 h-4" />
                                    <span>Viewer Controlled Themes</span>
                                </div>
                            </div>
                        </div>
                    </header>

                    <main className="max-w-7xl mx-auto px-4 md:px-6 py-8 md:py-12">
                        <div className="grid grid-cols-1 lg:grid-cols-12 gap-8 md:gap-10">
                            
                            {/* CONTROLS */}
                            <div className="lg:col-span-5 space-y-6 md:space-y-8 order-2 lg:order-1">
                                <div className="glass-panel p-5 md:p-6 rounded-2xl space-y-6 relative overflow-hidden group">
                                    <div className="absolute top-0 right-0 p-32 bg-purple-600/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 pointer-events-none"></div>
                                    
                                    <div>
                                        <label className="text-sm font-semibold text-slate-300 uppercase tracking-wider mb-3 block">YouTube URL</label>
                                        <div className="input-group relative">
                                            <input 
                                                type="text" 
                                                value={url}
                                                onChange={(e) => setUrl(e.target.value)}
                                                placeholder="Paste link here..."
                                                className="w-full bg-slate-900/80 border border-slate-700/50 rounded-xl px-4 py-4 pl-12 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50 transition-all shadow-inner text-sm md:text-base"
                                            />
                                            <div className="absolute left-4 top-1/2 -translate-y-1/2 text-slate-500"><Zap className="w-5 h-5" /></div>
                                        </div>
                                    </div>

                                    <div>
                                        <label className="text-sm font-semibold text-slate-300 uppercase tracking-wider mb-3 block">Default Theme</label>
                                        <div className="grid grid-cols-2 gap-3">
                                            {themes.map(t => (
                                                <button 
                                                    key={t.id}
                                                    onClick={() => setDefaultTheme(t.id)}
                                                    className={`p-3 rounded-xl border text-left transition-all duration-200 relative overflow-hidden ${defaultTheme === t.id ? 'bg-purple-600/20 border-purple-500/50 text-white shadow-lg shadow-purple-900/20' : 'bg-slate-800/30 border-slate-700/30 text-slate-400 hover:bg-slate-800/50'}`}
                                                >
                                                    <div className="relative z-10">
                                                        <div className="font-semibold text-sm">{t.name}</div>
                                                        <div className="text-xs opacity-60 mt-0.5">{t.desc}</div>
                                                    </div>
                                                    {defaultTheme === t.id && <div className="absolute inset-0 bg-gradient-to-r from-purple-600/10 to-transparent pointer-events-none"></div>}
                                                </button>
                                            ))}
                                        </div>
                                        <p className="text-xs text-slate-500 mt-3 flex items-center gap-1">
                                            <Wand className="w-3 h-3" /> Note: Viewers can change this using the magic wand icon.
                                        </p>
                                    </div>

                                    <div>
                                        <label className="text-sm font-semibold text-slate-300 uppercase tracking-wider mb-3 block">Export</label>
                                        <div className="flex bg-slate-900/50 p-1 rounded-xl border border-slate-800">
                                            <button onClick={() => setOutputMode('embed')} className={`flex-1 py-2 rounded-lg text-sm font-medium transition-all ${outputMode === 'embed' ? 'bg-slate-700 text-white shadow-sm' : 'text-slate-400 hover:text-white'}`}>Embed Code</button>
                                            <button onClick={() => setOutputMode('fullpage')} className={`flex-1 py-2 rounded-lg text-sm font-medium transition-all ${outputMode === 'fullpage' ? 'bg-slate-700 text-white shadow-sm' : 'text-slate-400 hover:text-white'}`}>Full HTML Page</button>
                                        </div>
                                    </div>
                                </div>

                                <div className="glass-panel rounded-2xl overflow-hidden flex flex-col">
                                    <div className="bg-black/40 px-5 md:px-6 py-4 flex items-center justify-between border-b border-white/5">
                                        <div className="flex items-center gap-2 text-slate-300">
                                            <Code className="w-4 h-4" />
                                            <span className="text-xs font-mono uppercase tracking-wider">Source Code</span>
                                        </div>
                                        <button 
                                            onClick={copyToClipboard}
                                            disabled={!videoId}
                                            className={`flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-bold uppercase tracking-wide transition-all ${copied ? 'bg-emerald-500 text-white animate-pop' : 'bg-white text-black hover:bg-slate-200'}`}
                                        >
                                            {copied ? <Check className="w-4 h-4" /> : <Copy className="w-4 h-4" />}
                                            {copied ? 'Copied' : 'Copy'}
                                        </button>
                                    </div>
                                    <div className="relative group">
                                        <pre className="text-xs font-mono text-slate-400 p-5 md:p-6 overflow-x-auto bg-slate-950/50 max-h-48 custom-scrollbar whitespace-pre-wrap break-all">
                                            {generateEmbed()}
                                        </pre>
                                        {!videoId && <div className="absolute inset-0 flex items-center justify-center bg-slate-950/80 backdrop-blur-sm text-slate-500 text-sm">Waiting for video...</div>}
                                    </div>
                                </div>
                            </div>

                            {/* PREVIEW */}
                            <div className="lg:col-span-7 order-1 lg:order-2">
                                <div className="sticky top-20 md:top-28 space-y-4">
                                    <div className="flex items-center justify-between px-2">
                                        <div className="flex items-center gap-2 text-white">
                                            <Monitor className="w-5 h-5 text-purple-400" />
                                            <h2 className="text-lg font-bold">Interactive Preview</h2>
                                        </div>
                                        <div className="flex items-center gap-2 text-xs text-slate-400">
                                            <div className="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></div>
                                            Try the <Wand className="w-3 h-3 inline mx-1" /> button!
                                        </div>
                                    </div>

                                    <div className="glass-panel p-4 md:p-8 rounded-3xl min-h-[300px] md:min-h-[500px] flex items-center justify-center relative overflow-hidden bg-slate-900/40">
                                        <div className="absolute inset-0" style={{backgroundImage: 'linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px)', backgroundSize: '40px 40px'}}></div>
                                        
                                        {videoId ? (
                                            <div className="relative z-10 w-full animate-fade-in" key={previewKey}>
                                                <div dangerouslySetInnerHTML={{ __html: generateEmbed() }} />
                                            </div>
                                        ) : (
                                            <div className="text-center relative z-10">
                                                <div className="w-16 h-16 md:w-24 md:h-24 bg-slate-800/50 rounded-2xl flex items-center justify-center mx-auto mb-6 border border-slate-700 rotate-3 transition-transform hover:rotate-6">
                                                    <Play className="w-8 h-8 md:w-10 md:h-10 text-slate-500" />
                                                </div>
                                                <h3 className="text-lg md:text-xl font-medium text-white mb-2">Waiting for Video</h3>
                                                <p className="text-slate-400 max-w-xs mx-auto text-sm">Paste a YouTube link. The output will include a "Magic Wand" so viewers can change themes.</p>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>

                        </div>
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
